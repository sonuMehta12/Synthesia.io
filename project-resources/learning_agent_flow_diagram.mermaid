graph TB
    %% Entry Points
    UserCommand[ğŸ‘¤ User Command] --> TriggerRouter
    ScheduledTask[â° Scheduled Task] --> TriggerRouter
    
    %% State Management Layer
    TriggerRouter[ğŸ¯ Trigger Router] --> StateManager
    StateManager[ğŸ“Š State Manager<br/>- User Profile<br/>- Knowledge Graph<br/>- Active Sessions] --> IntentClassifier
    
    %% Intent Processing
    IntentClassifier[ğŸ§  Intent Classifier<br/>- Learning Request<br/>- Knowledge Addition<br/>- Summary Generation<br/>- Profile Update] --> RouterGate{Route Decision}
    
    %% Learning Flow Path
    RouterGate -->|Learning Request| LearningOrchestrator
    LearningOrchestrator[ğŸ“ Learning Orchestrator] --> ContextRetriever
    ContextRetriever[ğŸ“š Context Retriever<br/>- User Profile Slice<br/>- Relevant Knowledge<br/>- Recent Activities] --> PreResearchValidator
    
    PreResearchValidator[âœ… Pre-Research Validator<br/>- Topic Complexity Check<br/>- Resource Requirements<br/>- Time Estimation] --> ResearchCoordinator
    
    %% Multi-Agent Research Layer
    ResearchCoordinator[ğŸ”¬ Research Coordinator] --> ParallelResearch
    subgraph ParallelResearch["ğŸš€ Parallel Research Agents"]
        AcademicAgent[ğŸ“– Academic Agent<br/>Papers, Books, Courses]
        ExpertAgent[ğŸ‘¨â€ğŸ« Expert Agent<br/>Thought Leaders, Authors]
        PracticalAgent[ğŸ”§ Practical Agent<br/>Projects, Tools, Tutorials]
        CommunityAgent[ğŸŒ Community Agent<br/>Forums, Discord, Reddit]
        NewsAgent[ğŸ“° News Agent<br/>Latest Developments]
    end
    
    %% Research Synthesis
    ParallelResearch --> ResearchSynthesizer
    ResearchSynthesizer[âš¡ Research Synthesizer<br/>- Deduplication<br/>- Quality Scoring<br/>- Relevance Filtering] --> QualityGate
    
    QualityGate[ğŸ›¡ï¸ Quality Gate<br/>- Completeness Check<br/>- Source Credibility<br/>- Bias Detection] --> RoadmapGenerator
    
    %% Roadmap Creation Flow
    RoadmapGenerator[ğŸ—ºï¸ Roadmap Generator] --> UserCollaborator
    UserCollaborator[ğŸ¤ User Collaborator<br/>- Present Draft<br/>- Collect Feedback<br/>- Iterate Design] --> RoadmapApproval{User Approved?}
    
    RoadmapApproval -->|No| UserCollaborator
    RoadmapApproval -->|Yes| BookWriter
    
    %% Content Generation
    BookWriter[ğŸ“ Book Writer<br/>- Structured Content<br/>- Markdown Formatting<br/>- Interactive Elements] --> ContentValidator
    ContentValidator[âœ… Content Validator<br/>- Accuracy Check<br/>- Coherence Review<br/>- Format Validation] --> DeliveryManager
    
    %% Daily Summary Flow Path
    RouterGate -->|Summary Generation| SummaryOrchestrator
    SummaryOrchestrator[ğŸ“‹ Summary Orchestrator] --> ContentAggregator
    
    subgraph ContentAggregator["ğŸ“¡ Content Aggregation Layer"]
        EmailMonitor[ğŸ“§ Email Monitor<br/>Newsletter Processing]
        LinkedInMonitor[ğŸ’¼ LinkedIn Monitor<br/>Feed Analysis]
        YouTubeMonitor[ğŸ“º YouTube Monitor<br/>Video Summaries]
        SubstackMonitor[ğŸ“ Substack Monitor<br/>Article Processing]
    end
    
    ContentAggregator --> NoiseFilter
    NoiseFilter[ğŸ” Noise Filter<br/>- Relevance Scoring<br/>- Duplicate Removal<br/>- User Interest Matching] --> SummaryGenerator
    
    SummaryGenerator[ğŸ“Š Summary Generator<br/>- Key Insights<br/>- Action Items<br/>- Learning Opportunities] --> MergeProposer
    
    MergeProposer[ğŸ”— Merge Proposer<br/>- Identify Integration Points<br/>- Suggest Knowledge Updates<br/>- Recommend New Topics] --> SummaryDelivery
    
    %% Knowledge Addition Flow
    RouterGate -->|Knowledge Addition| KnowledgeProcessor
    KnowledgeProcessor[ğŸ§© Knowledge Processor<br/>- Content Analysis<br/>- Topic Classification<br/>- Integration Strategy] --> KnowledgeValidator
    
    KnowledgeValidator[âœ… Knowledge Validator<br/>- Accuracy Verification<br/>- Redundancy Check<br/>- Quality Assessment] --> KnowledgeIntegrator
    
    KnowledgeIntegrator[ğŸ”§ Knowledge Integrator<br/>- Update Existing Books<br/>- Create New Sections<br/>- Maintain References] --> KnowledgeGraph
    
    %% Central Knowledge Store
    KnowledgeGraph[ğŸ•¸ï¸ Knowledge Graph<br/>- Topic Relationships<br/>- Mastery Levels<br/>- Source Tracking<br/>- Version Control]
    
    %% Delivery and Feedback
    DeliveryManager[ğŸ“¤ Delivery Manager] --> UserInterface
    SummaryDelivery[ğŸ“¤ Summary Delivery] --> UserInterface
    UserInterface[ğŸ’» User Interface<br/>- Markdown Viewer<br/>- Feedback Collection<br/>- Progress Tracking] --> FeedbackProcessor
    
    FeedbackProcessor[ğŸ”„ Feedback Processor<br/>- Performance Analysis<br/>- System Optimization<br/>- Profile Updates] --> StateManager
    
    %% Error Handling and Recovery
    subgraph ErrorHandling["ğŸš¨ Error Handling Layer"]
        ErrorDetector[âš ï¸ Error Detector]
        FallbackManager[ğŸ”„ Fallback Manager]
        RetryOrchestrator[ğŸ” Retry Orchestrator]
    end
    
    %% External Integrations
    subgraph ExternalAPIs["ğŸŒ External APIs"]
        SearchAPIs[ğŸ” Search APIs<br/>Google, Bing, Academic]
        SocialAPIs[ğŸ“± Social Media APIs<br/>LinkedIn, YouTube, X]
        EmailAPIs[ğŸ“§ Email APIs<br/>Gmail, Outlook]
        DatabaseAPIs[ğŸ’¾ Vector Databases<br/>Pinecone, Weaviate]
    end
    
    %% Connect error handling
    ResearchCoordinator -.-> ErrorDetector
    BookWriter -.-> ErrorDetector
    SummaryGenerator -.-> ErrorDetector
    
    %% Connect external APIs
    ParallelResearch -.-> SearchAPIs
    ContentAggregator -.-> SocialAPIs
    ContentAggregator -.-> EmailAPIs
    KnowledgeGraph -.-> DatabaseAPIs
    
    %% Styling
    classDef userNode fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef orchestrator fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef agent fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef validator fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef storage fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef external fill:#f1f8e9,stroke:#33691e,stroke-width:2px
    
    class UserCommand,UserInterface userNode
    class LearningOrchestrator,SummaryOrchestrator,ResearchCoordinator orchestrator
    class AcademicAgent,ExpertAgent,PracticalAgent,CommunityAgent,NewsAgent agent
    class PreResearchValidator,QualityGate,ContentValidator,KnowledgeValidator validator
    class StateManager,KnowledgeGraph storage
    class ExternalAPIs,SearchAPIs,SocialAPIs,EmailAPIs,DatabaseAPIs external